drop table if exists t1, t2;
create table t1(a int, b int, c int) partition by hash(a) partitions 5;
create table t2(a int, b int, c int) partition by hash(a) partitions 5;
insert into t1 values (1, 1, 1);
insert into t1 values (1, 1, 1);
insert into t1 values (3, 3, 3);
insert into t1 values (4, 4, 4);
insert into t2 values (2, 2, 2);
insert into t2 values (3, 3, 3);
insert into t2 values (4, 4, 4);
insert into t2 values (5, 5, 5);
result_format: 4
explain_protocol: 2
###test case where we can normal result
EXPLAIN select * from (select 1 c1, 1 c2) t3 inner join t1 on t3.c1 = t1.a;
Query Plan
===============================================
|ID|OPERATOR       |NAME|EST.ROWS|EST.TIME(us)|
-----------------------------------------------
|0 |TABLE FULL SCAN|t1  |1       |3           |
===============================================
Outputs & filters:
-------------------------------------
  0 - output([1], [1], [t1.a], [t1.b], [t1.c]), filter([t1.a = 1]), rowset=16
      access([t1.a], [t1.b], [t1.c]), partitions(p1)
      is_index_back=false, is_global_index=false, filter_before_indexback[false],
      range_key([t1.__pk_increment]), range(MIN ; MAX)always true
select * from (select 1 c1, 1 c2) t3 inner join t1 on t3.c1 = t1.a;
+----+----+------+------+------+
| c1 | c2 | a    | b    | c    |
+----+----+------+------+------+
|  1 |  1 |    1 |    1 |    1 |
|  1 |  1 |    1 |    1 |    1 |
+----+----+------+------+------+
EXPLAIN select * from (select 1 c1, 1 c2) t3 left join t1 on t3.c1 = t1.a;
Query Plan
=================================================================
|ID|OPERATOR                         |NAME|EST.ROWS|EST.TIME(us)|
-----------------------------------------------------------------
|0 |NESTED-LOOP OUTER JOIN CARTESIAN |    |1       |4           |
|1 |├─SUBPLAN SCAN                   |t3  |1       |1           |
|2 |│ └─EXPRESSION                   |    |1       |1           |
|3 |└─TABLE FULL SCAN                |t1  |1       |3           |
=================================================================
Outputs & filters:
-------------------------------------
  0 - output([t3.c1], [t3.c2], [t1.a], [t1.b], [t1.c]), filter(nil), rowset=16
      conds(nil), nl_params_(nil), use_batch=false
  1 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
      access([t3.c1], [t3.c2])
  2 - output([1], [1]), filter(nil)
      values({1, 1})
  3 - output([t1.a], [t1.b], [t1.c]), filter([1 = t1.a]), rowset=16
      access([t1.a], [t1.b], [t1.c]), partitions(p1)
      is_index_back=false, is_global_index=false, filter_before_indexback[false],
      range_key([t1.__pk_increment]), range(MIN ; MAX)always true
select * from (select 1 c1, 1 c2) t3 left join t1 on t3.c1 = t1.a;
+----+----+------+------+------+
| c1 | c2 | a    | b    | c    |
+----+----+------+------+------+
|  1 |  1 |    1 |    1 |    1 |
|  1 |  1 |    1 |    1 |    1 |
+----+----+------+------+------+
EXPLAIN select * from (select 1 c1, 1 c2) t3 right join t1 on t3.c1 = t1.a;
Query Plan
===============================================================
|ID|OPERATOR                   |NAME    |EST.ROWS|EST.TIME(us)|
---------------------------------------------------------------
|0 |PX COORDINATOR             |        |4       |21          |
|1 |└─EXCHANGE OUT DISTR       |:EX10000|4       |18          |
|2 |  └─NESTED-LOOP OUTER JOIN |        |4       |11          |
|3 |    ├─PX PARTITION ITERATOR|        |4       |11          |
|4 |    │ └─TABLE FULL SCAN    |t1      |4       |11          |
|5 |    └─MATERIAL             |        |1       |1           |
|6 |      └─SUBPLAN SCAN       |t3      |1       |1           |
|7 |        └─EXPRESSION       |        |1       |1           |
===============================================================
Outputs & filters:
-------------------------------------
  0 - output([INTERNAL_FUNCTION(t3.c1, t3.c2, t1.a, t1.b, t1.c)]), filter(nil), rowset=16
  1 - output([INTERNAL_FUNCTION(t3.c1, t3.c2, t1.a, t1.b, t1.c)]), filter(nil), rowset=16
      dop=1
  2 - output([t1.a], [t1.b], [t1.c], [t3.c1], [t3.c2]), filter(nil), rowset=16
      conds([1 = t1.a]), nl_params_(nil), use_batch=false
  3 - output([t1.a], [t1.b], [t1.c]), filter(nil), rowset=16
      force partition granule
  4 - output([t1.a], [t1.b], [t1.c]), filter(nil), rowset=16
      access([t1.a], [t1.b], [t1.c]), partitions(p[0-4])
      is_index_back=false, is_global_index=false,
      range_key([t1.__pk_increment]), range(MIN ; MAX)always true
  5 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
  6 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
      access([t3.c1], [t3.c2])
  7 - output([1], [1]), filter(nil)
      values({1, 1})
select * from (select 1 c1, 1 c2) t3 right join t1 on t3.c1 = t1.a;
+----+----+------+------+------+
| c1 | c2 | a    | b    | c    |
+----+----+------+------+------+
|  1 |  1 |    1 |    1 |    1 |
|  1 |  1 |    1 |    1 |    1 |
| NULL | NULL |    3 |    3 |    3 |
| NULL | NULL |    4 |    4 |    4 |
+----+----+------+------+------+
EXPLAIN select * from (select 1 c1, 1 c2) t3 full join t1 on t3.c1 = t1.a;
Query Plan
=====================================================================
|ID|OPERATOR                         |NAME    |EST.ROWS|EST.TIME(us)|
---------------------------------------------------------------------
|0 |PX COORDINATOR                   |        |4       |23          |
|1 |└─EXCHANGE OUT DISTR             |:EX10001|4       |20          |
|2 |  └─HASH FULL OUTER JOIN         |        |4       |13          |
|3 |    ├─EXCHANGE IN DISTR          |        |1       |1           |
|4 |    │ └─EXCHANGE OUT DISTR (PKEY)|:EX10000|1       |1           |
|5 |    │   └─SUBPLAN SCAN           |t3      |1       |1           |
|6 |    │     └─EXPRESSION           |        |1       |1           |
|7 |    └─PX PARTITION ITERATOR      |        |4       |11          |
|8 |      └─TABLE FULL SCAN          |t1      |4       |11          |
=====================================================================
Outputs & filters:
-------------------------------------
  0 - output([INTERNAL_FUNCTION(t3.c1, t3.c2, t1.a, t1.b, t1.c)]), filter(nil), rowset=16
  1 - output([INTERNAL_FUNCTION(t3.c1, t3.c2, t1.a, t1.b, t1.c)]), filter(nil), rowset=16
      dop=1
  2 - output([t3.c1], [t1.a], [t3.c2], [t1.b], [t1.c]), filter(nil), rowset=16
      equal_conds([t3.c1 = t1.a]), other_conds(nil)
  3 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
  4 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
      (#keys=1, [t3.c1]), is_single, dop=1
  5 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
      access([t3.c1], [t3.c2])
  6 - output([1], [1]), filter(nil)
      values({1, 1})
  7 - output([t1.a], [t1.b], [t1.c]), filter(nil), rowset=16
      affinitize, force partition granule
  8 - output([t1.a], [t1.b], [t1.c]), filter(nil), rowset=16
      access([t1.a], [t1.b], [t1.c]), partitions(p[0-4])
      is_index_back=false, is_global_index=false,
      range_key([t1.__pk_increment]), range(MIN ; MAX)always true
select * from (select 1 c1, 1 c2) t3 full join t1 on t3.c1 = t1.a;
+----+----+------+------+------+
| c1 | c2 | a    | b    | c    |
+----+----+------+------+------+
|  1 |  1 |    1 |    1 |    1 |
|  1 |  1 |    1 |    1 |    1 |
| NULL | NULL |    3 |    3 |    3 |
| NULL | NULL |    4 |    4 |    4 |
+----+----+------+------+------+
EXPLAIN select * from t1 inner join (select 1 c1, 1 c2) t3 on t3.c1 = t1.a;
Query Plan
===============================================
|ID|OPERATOR       |NAME|EST.ROWS|EST.TIME(us)|
-----------------------------------------------
|0 |TABLE FULL SCAN|t1  |1       |3           |
===============================================
Outputs & filters:
-------------------------------------
  0 - output([t1.a], [t1.b], [t1.c], [1], [1]), filter([t1.a = 1]), rowset=16
      access([t1.a], [t1.b], [t1.c]), partitions(p1)
      is_index_back=false, is_global_index=false, filter_before_indexback[false],
      range_key([t1.__pk_increment]), range(MIN ; MAX)always true
select * from t1 inner join (select 1 c1, 1 c2) t3 on t3.c1 = t1.a;
+------+------+------+----+----+
| a    | b    | c    | c1 | c2 |
+------+------+------+----+----+
|    1 |    1 |    1 |  1 |  1 |
|    1 |    1 |    1 |  1 |  1 |
+------+------+------+----+----+
EXPLAIN select * from t1 left join (select 1 c1, 1 c2) t3 on t3.c1 = t1.a;
Query Plan
===============================================================
|ID|OPERATOR                   |NAME    |EST.ROWS|EST.TIME(us)|
---------------------------------------------------------------
|0 |PX COORDINATOR             |        |4       |21          |
|1 |└─EXCHANGE OUT DISTR       |:EX10000|4       |18          |
|2 |  └─NESTED-LOOP OUTER JOIN |        |4       |11          |
|3 |    ├─PX PARTITION ITERATOR|        |4       |11          |
|4 |    │ └─TABLE FULL SCAN    |t1      |4       |11          |
|5 |    └─MATERIAL             |        |1       |1           |
|6 |      └─SUBPLAN SCAN       |t3      |1       |1           |
|7 |        └─EXPRESSION       |        |1       |1           |
===============================================================
Outputs & filters:
-------------------------------------
  0 - output([INTERNAL_FUNCTION(t1.a, t1.b, t1.c, t3.c1, t3.c2)]), filter(nil), rowset=16
  1 - output([INTERNAL_FUNCTION(t1.a, t1.b, t1.c, t3.c1, t3.c2)]), filter(nil), rowset=16
      dop=1
  2 - output([t1.a], [t1.b], [t1.c], [t3.c1], [t3.c2]), filter(nil), rowset=16
      conds([1 = t1.a]), nl_params_(nil), use_batch=false
  3 - output([t1.a], [t1.b], [t1.c]), filter(nil), rowset=16
      force partition granule
  4 - output([t1.a], [t1.b], [t1.c]), filter(nil), rowset=16
      access([t1.a], [t1.b], [t1.c]), partitions(p[0-4])
      is_index_back=false, is_global_index=false,
      range_key([t1.__pk_increment]), range(MIN ; MAX)always true
  5 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
  6 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
      access([t3.c1], [t3.c2])
  7 - output([1], [1]), filter(nil)
      values({1, 1})
select * from t1 left join (select 1 c1, 1 c2) t3 on t3.c1 = t1.a;
+------+------+------+----+----+
| a    | b    | c    | c1 | c2 |
+------+------+------+----+----+
|    1 |    1 |    1 |  1 |  1 |
|    1 |    1 |    1 |  1 |  1 |
|    3 |    3 |    3 | NULL | NULL |
|    4 |    4 |    4 | NULL | NULL |
+------+------+------+----+----+
EXPLAIN select * from t1 right join (select 1 c1, 1 c2) t3 on t3.c1 = t1.a;
Query Plan
=================================================================
|ID|OPERATOR                         |NAME|EST.ROWS|EST.TIME(us)|
-----------------------------------------------------------------
|0 |NESTED-LOOP OUTER JOIN CARTESIAN |    |1       |4           |
|1 |├─SUBPLAN SCAN                   |t3  |1       |1           |
|2 |│ └─EXPRESSION                   |    |1       |1           |
|3 |└─TABLE FULL SCAN                |t1  |1       |3           |
=================================================================
Outputs & filters:
-------------------------------------
  0 - output([t1.a], [t1.b], [t1.c], [t3.c1], [t3.c2]), filter(nil), rowset=16
      conds(nil), nl_params_(nil), use_batch=false
  1 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
      access([t3.c1], [t3.c2])
  2 - output([1], [1]), filter(nil)
      values({1, 1})
  3 - output([t1.a], [t1.b], [t1.c]), filter([1 = t1.a]), rowset=16
      access([t1.a], [t1.b], [t1.c]), partitions(p1)
      is_index_back=false, is_global_index=false, filter_before_indexback[false],
      range_key([t1.__pk_increment]), range(MIN ; MAX)always true
select * from t1 right join (select 1 c1, 1 c2) t3 on t3.c1 = t1.a;
+------+------+------+----+----+
| a    | b    | c    | c1 | c2 |
+------+------+------+----+----+
|    1 |    1 |    1 |  1 |  1 |
|    1 |    1 |    1 |  1 |  1 |
+------+------+------+----+----+
EXPLAIN select * from t1 full join (select 1 c1, 1 c2) t3 on t3.c1 = t1.a;
Query Plan
=====================================================================
|ID|OPERATOR                         |NAME    |EST.ROWS|EST.TIME(us)|
---------------------------------------------------------------------
|0 |PX COORDINATOR                   |        |4       |23          |
|1 |└─EXCHANGE OUT DISTR             |:EX10001|4       |20          |
|2 |  └─HASH FULL OUTER JOIN         |        |4       |13          |
|3 |    ├─EXCHANGE IN DISTR          |        |1       |1           |
|4 |    │ └─EXCHANGE OUT DISTR (PKEY)|:EX10000|1       |1           |
|5 |    │   └─SUBPLAN SCAN           |t3      |1       |1           |
|6 |    │     └─EXPRESSION           |        |1       |1           |
|7 |    └─PX PARTITION ITERATOR      |        |4       |11          |
|8 |      └─TABLE FULL SCAN          |t1      |4       |11          |
=====================================================================
Outputs & filters:
-------------------------------------
  0 - output([INTERNAL_FUNCTION(t1.a, t1.b, t1.c, t3.c1, t3.c2)]), filter(nil), rowset=16
  1 - output([INTERNAL_FUNCTION(t1.a, t1.b, t1.c, t3.c1, t3.c2)]), filter(nil), rowset=16
      dop=1
  2 - output([t3.c1], [t1.a], [t3.c2], [t1.b], [t1.c]), filter(nil), rowset=16
      equal_conds([t3.c1 = t1.a]), other_conds(nil)
  3 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
  4 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
      (#keys=1, [t3.c1]), is_single, dop=1
  5 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
      access([t3.c1], [t3.c2])
  6 - output([1], [1]), filter(nil)
      values({1, 1})
  7 - output([t1.a], [t1.b], [t1.c]), filter(nil), rowset=16
      affinitize, force partition granule
  8 - output([t1.a], [t1.b], [t1.c]), filter(nil), rowset=16
      access([t1.a], [t1.b], [t1.c]), partitions(p[0-4])
      is_index_back=false, is_global_index=false,
      range_key([t1.__pk_increment]), range(MIN ; MAX)always true
select * from t1 full join (select 1 c1, 1 c2) t3 on t3.c1 = t1.a;
+------+------+------+----+----+
| a    | b    | c    | c1 | c2 |
+------+------+------+----+----+
|    1 |    1 |    1 |  1 |  1 |
|    1 |    1 |    1 |  1 |  1 |
|    3 |    3 |    3 | NULL | NULL |
|    4 |    4 |    4 | NULL | NULL |
+------+------+------+----+----+

###test case where we get null results
EXPLAIN select * from (select 1 c1, 1 c2) t3 inner join t2 on t3.c1 = t2.a;
Query Plan
===============================================
|ID|OPERATOR       |NAME|EST.ROWS|EST.TIME(us)|
-----------------------------------------------
|0 |TABLE FULL SCAN|t2  |1       |3           |
===============================================
Outputs & filters:
-------------------------------------
  0 - output([1], [1], [t2.a], [t2.b], [t2.c]), filter([t2.a = 1]), rowset=16
      access([t2.a], [t2.b], [t2.c]), partitions(p1)
      is_index_back=false, is_global_index=false, filter_before_indexback[false],
      range_key([t2.__pk_increment]), range(MIN ; MAX)always true
select * from (select 1 c1, 1 c2) t3 inner join t2 on t3.c1 = t2.a;
+----+----+------+------+------+
| c1 | c2 | a    | b    | c    |
+----+----+------+------+------+
+----+----+------+------+------+
EXPLAIN select * from (select 1 c1, 1 c2) t3 left join t2 on t3.c1 = t2.a;
Query Plan
=================================================================
|ID|OPERATOR                         |NAME|EST.ROWS|EST.TIME(us)|
-----------------------------------------------------------------
|0 |NESTED-LOOP OUTER JOIN CARTESIAN |    |1       |4           |
|1 |├─SUBPLAN SCAN                   |t3  |1       |1           |
|2 |│ └─EXPRESSION                   |    |1       |1           |
|3 |└─TABLE FULL SCAN                |t2  |1       |3           |
=================================================================
Outputs & filters:
-------------------------------------
  0 - output([t3.c1], [t3.c2], [t2.a], [t2.b], [t2.c]), filter(nil), rowset=16
      conds(nil), nl_params_(nil), use_batch=false
  1 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
      access([t3.c1], [t3.c2])
  2 - output([1], [1]), filter(nil)
      values({1, 1})
  3 - output([t2.a], [t2.b], [t2.c]), filter([1 = t2.a]), rowset=16
      access([t2.a], [t2.b], [t2.c]), partitions(p1)
      is_index_back=false, is_global_index=false, filter_before_indexback[false],
      range_key([t2.__pk_increment]), range(MIN ; MAX)always true
select * from (select 1 c1, 1 c2) t3 left join t2 on t3.c1 = t2.a;
+----+----+------+------+------+
| c1 | c2 | a    | b    | c    |
+----+----+------+------+------+
|  1 |  1 | NULL | NULL | NULL |
+----+----+------+------+------+
EXPLAIN select * from (select 1 c1, 1 c2) t3 right join t2 on t3.c1 = t2.a;
Query Plan
===============================================================
|ID|OPERATOR                   |NAME    |EST.ROWS|EST.TIME(us)|
---------------------------------------------------------------
|0 |PX COORDINATOR             |        |4       |21          |
|1 |└─EXCHANGE OUT DISTR       |:EX10000|4       |18          |
|2 |  └─NESTED-LOOP OUTER JOIN |        |4       |11          |
|3 |    ├─PX PARTITION ITERATOR|        |4       |11          |
|4 |    │ └─TABLE FULL SCAN    |t2      |4       |11          |
|5 |    └─MATERIAL             |        |1       |1           |
|6 |      └─SUBPLAN SCAN       |t3      |1       |1           |
|7 |        └─EXPRESSION       |        |1       |1           |
===============================================================
Outputs & filters:
-------------------------------------
  0 - output([INTERNAL_FUNCTION(t3.c1, t3.c2, t2.a, t2.b, t2.c)]), filter(nil), rowset=16
  1 - output([INTERNAL_FUNCTION(t3.c1, t3.c2, t2.a, t2.b, t2.c)]), filter(nil), rowset=16
      dop=1
  2 - output([t2.a], [t2.b], [t2.c], [t3.c1], [t3.c2]), filter(nil), rowset=16
      conds([1 = t2.a]), nl_params_(nil), use_batch=false
  3 - output([t2.a], [t2.b], [t2.c]), filter(nil), rowset=16
      force partition granule
  4 - output([t2.a], [t2.b], [t2.c]), filter(nil), rowset=16
      access([t2.a], [t2.b], [t2.c]), partitions(p[0-4])
      is_index_back=false, is_global_index=false,
      range_key([t2.__pk_increment]), range(MIN ; MAX)always true
  5 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
  6 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
      access([t3.c1], [t3.c2])
  7 - output([1], [1]), filter(nil)
      values({1, 1})
select * from (select 1 c1, 1 c2) t3 right join t2 on t3.c1 = t2.a;
+----+----+------+------+------+
| c1 | c2 | a    | b    | c    |
+----+----+------+------+------+
| NULL | NULL |    5 |    5 |    5 |
| NULL | NULL |    2 |    2 |    2 |
| NULL | NULL |    3 |    3 |    3 |
| NULL | NULL |    4 |    4 |    4 |
+----+----+------+------+------+
EXPLAIN select * from (select 1 c1, 1 c2) t3 full join t2 on t3.c1 = t2.a;
Query Plan
=====================================================================
|ID|OPERATOR                         |NAME    |EST.ROWS|EST.TIME(us)|
---------------------------------------------------------------------
|0 |PX COORDINATOR                   |        |4       |23          |
|1 |└─EXCHANGE OUT DISTR             |:EX10001|4       |20          |
|2 |  └─HASH FULL OUTER JOIN         |        |4       |13          |
|3 |    ├─EXCHANGE IN DISTR          |        |1       |1           |
|4 |    │ └─EXCHANGE OUT DISTR (PKEY)|:EX10000|1       |1           |
|5 |    │   └─SUBPLAN SCAN           |t3      |1       |1           |
|6 |    │     └─EXPRESSION           |        |1       |1           |
|7 |    └─PX PARTITION ITERATOR      |        |4       |11          |
|8 |      └─TABLE FULL SCAN          |t2      |4       |11          |
=====================================================================
Outputs & filters:
-------------------------------------
  0 - output([INTERNAL_FUNCTION(t3.c1, t3.c2, t2.a, t2.b, t2.c)]), filter(nil), rowset=16
  1 - output([INTERNAL_FUNCTION(t3.c1, t3.c2, t2.a, t2.b, t2.c)]), filter(nil), rowset=16
      dop=1
  2 - output([t3.c1], [t2.a], [t3.c2], [t2.b], [t2.c]), filter(nil), rowset=16
      equal_conds([t3.c1 = t2.a]), other_conds(nil)
  3 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
  4 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
      (#keys=1, [t3.c1]), is_single, dop=1
  5 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
      access([t3.c1], [t3.c2])
  6 - output([1], [1]), filter(nil)
      values({1, 1})
  7 - output([t2.a], [t2.b], [t2.c]), filter(nil), rowset=16
      affinitize, force partition granule
  8 - output([t2.a], [t2.b], [t2.c]), filter(nil), rowset=16
      access([t2.a], [t2.b], [t2.c]), partitions(p[0-4])
      is_index_back=false, is_global_index=false,
      range_key([t2.__pk_increment]), range(MIN ; MAX)always true
select * from (select 1 c1, 1 c2) t3 full join t2 on t3.c1 = t2.a;
+----+----+------+------+------+
| c1 | c2 | a    | b    | c    |
+----+----+------+------+------+
| NULL | NULL |    5 |    5 |    5 |
| NULL | NULL |    2 |    2 |    2 |
| NULL | NULL |    3 |    3 |    3 |
| NULL | NULL |    4 |    4 |    4 |
|  1 |  1 | NULL | NULL | NULL |
+----+----+------+------+------+
EXPLAIN select * from t2 inner join (select 1 c1, 1 c2) t3 on t3.c1 = t2.a;
Query Plan
===============================================
|ID|OPERATOR       |NAME|EST.ROWS|EST.TIME(us)|
-----------------------------------------------
|0 |TABLE FULL SCAN|t2  |1       |3           |
===============================================
Outputs & filters:
-------------------------------------
  0 - output([t2.a], [t2.b], [t2.c], [1], [1]), filter([t2.a = 1]), rowset=16
      access([t2.a], [t2.b], [t2.c]), partitions(p1)
      is_index_back=false, is_global_index=false, filter_before_indexback[false],
      range_key([t2.__pk_increment]), range(MIN ; MAX)always true
select * from t2 inner join (select 1 c1, 1 c2) t3 on t3.c1 = t2.a;
+------+------+------+----+----+
| a    | b    | c    | c1 | c2 |
+------+------+------+----+----+
+------+------+------+----+----+
EXPLAIN select * from t2 left join (select 1 c1, 1 c2) t3 on t3.c1 = t2.a;
Query Plan
===============================================================
|ID|OPERATOR                   |NAME    |EST.ROWS|EST.TIME(us)|
---------------------------------------------------------------
|0 |PX COORDINATOR             |        |4       |21          |
|1 |└─EXCHANGE OUT DISTR       |:EX10000|4       |18          |
|2 |  └─NESTED-LOOP OUTER JOIN |        |4       |11          |
|3 |    ├─PX PARTITION ITERATOR|        |4       |11          |
|4 |    │ └─TABLE FULL SCAN    |t2      |4       |11          |
|5 |    └─MATERIAL             |        |1       |1           |
|6 |      └─SUBPLAN SCAN       |t3      |1       |1           |
|7 |        └─EXPRESSION       |        |1       |1           |
===============================================================
Outputs & filters:
-------------------------------------
  0 - output([INTERNAL_FUNCTION(t2.a, t2.b, t2.c, t3.c1, t3.c2)]), filter(nil), rowset=16
  1 - output([INTERNAL_FUNCTION(t2.a, t2.b, t2.c, t3.c1, t3.c2)]), filter(nil), rowset=16
      dop=1
  2 - output([t2.a], [t2.b], [t2.c], [t3.c1], [t3.c2]), filter(nil), rowset=16
      conds([1 = t2.a]), nl_params_(nil), use_batch=false
  3 - output([t2.a], [t2.b], [t2.c]), filter(nil), rowset=16
      force partition granule
  4 - output([t2.a], [t2.b], [t2.c]), filter(nil), rowset=16
      access([t2.a], [t2.b], [t2.c]), partitions(p[0-4])
      is_index_back=false, is_global_index=false,
      range_key([t2.__pk_increment]), range(MIN ; MAX)always true
  5 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
  6 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
      access([t3.c1], [t3.c2])
  7 - output([1], [1]), filter(nil)
      values({1, 1})
select * from t2 left join (select 1 c1, 1 c2) t3 on t3.c1 = t2.a;
+------+------+------+----+----+
| a    | b    | c    | c1 | c2 |
+------+------+------+----+----+
|    5 |    5 |    5 | NULL | NULL |
|    2 |    2 |    2 | NULL | NULL |
|    3 |    3 |    3 | NULL | NULL |
|    4 |    4 |    4 | NULL | NULL |
+------+------+------+----+----+
EXPLAIN select * from t2 right join (select 1 c1, 1 c2) t3 on t3.c1 = t2.a;
Query Plan
=================================================================
|ID|OPERATOR                         |NAME|EST.ROWS|EST.TIME(us)|
-----------------------------------------------------------------
|0 |NESTED-LOOP OUTER JOIN CARTESIAN |    |1       |4           |
|1 |├─SUBPLAN SCAN                   |t3  |1       |1           |
|2 |│ └─EXPRESSION                   |    |1       |1           |
|3 |└─TABLE FULL SCAN                |t2  |1       |3           |
=================================================================
Outputs & filters:
-------------------------------------
  0 - output([t2.a], [t2.b], [t2.c], [t3.c1], [t3.c2]), filter(nil), rowset=16
      conds(nil), nl_params_(nil), use_batch=false
  1 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
      access([t3.c1], [t3.c2])
  2 - output([1], [1]), filter(nil)
      values({1, 1})
  3 - output([t2.a], [t2.b], [t2.c]), filter([1 = t2.a]), rowset=16
      access([t2.a], [t2.b], [t2.c]), partitions(p1)
      is_index_back=false, is_global_index=false, filter_before_indexback[false],
      range_key([t2.__pk_increment]), range(MIN ; MAX)always true
select * from t2 right join (select 1 c1, 1 c2) t3 on t3.c1 = t2.a;
+------+------+------+----+----+
| a    | b    | c    | c1 | c2 |
+------+------+------+----+----+
| NULL | NULL | NULL |  1 |  1 |
+------+------+------+----+----+
EXPLAIN select * from t2 full join (select 1 c1, 1 c2) t3 on t3.c1 = t2.a;
Query Plan
=====================================================================
|ID|OPERATOR                         |NAME    |EST.ROWS|EST.TIME(us)|
---------------------------------------------------------------------
|0 |PX COORDINATOR                   |        |4       |23          |
|1 |└─EXCHANGE OUT DISTR             |:EX10001|4       |20          |
|2 |  └─HASH FULL OUTER JOIN         |        |4       |13          |
|3 |    ├─EXCHANGE IN DISTR          |        |1       |1           |
|4 |    │ └─EXCHANGE OUT DISTR (PKEY)|:EX10000|1       |1           |
|5 |    │   └─SUBPLAN SCAN           |t3      |1       |1           |
|6 |    │     └─EXPRESSION           |        |1       |1           |
|7 |    └─PX PARTITION ITERATOR      |        |4       |11          |
|8 |      └─TABLE FULL SCAN          |t2      |4       |11          |
=====================================================================
Outputs & filters:
-------------------------------------
  0 - output([INTERNAL_FUNCTION(t2.a, t2.b, t2.c, t3.c1, t3.c2)]), filter(nil), rowset=16
  1 - output([INTERNAL_FUNCTION(t2.a, t2.b, t2.c, t3.c1, t3.c2)]), filter(nil), rowset=16
      dop=1
  2 - output([t3.c1], [t2.a], [t3.c2], [t2.b], [t2.c]), filter(nil), rowset=16
      equal_conds([t3.c1 = t2.a]), other_conds(nil)
  3 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
  4 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
      (#keys=1, [t3.c1]), is_single, dop=1
  5 - output([t3.c1], [t3.c2]), filter(nil), rowset=16
      access([t3.c1], [t3.c2])
  6 - output([1], [1]), filter(nil)
      values({1, 1})
  7 - output([t2.a], [t2.b], [t2.c]), filter(nil), rowset=16
      affinitize, force partition granule
  8 - output([t2.a], [t2.b], [t2.c]), filter(nil), rowset=16
      access([t2.a], [t2.b], [t2.c]), partitions(p[0-4])
      is_index_back=false, is_global_index=false,
      range_key([t2.__pk_increment]), range(MIN ; MAX)always true
select * from t2 full join (select 1 c1, 1 c2) t3 on t3.c1 = t2.a;
+------+------+------+----+----+
| a    | b    | c    | c1 | c2 |
+------+------+------+----+----+
|    5 |    5 |    5 | NULL | NULL |
|    2 |    2 |    2 | NULL | NULL |
|    3 |    3 |    3 | NULL | NULL |
|    4 |    4 |    4 | NULL | NULL |
| NULL | NULL | NULL |  1 |  1 |
+------+------+------+----+----+
