drop table if exists t1;
result_format: 4
create table t1(a int, b int) partition by hash(b) partitions 5;
create index i1 on t1(a) local;
insert into t1 values(1, 2);
explain select /*+ index(t1 I1) */ distinct sum(b) a from t1 group by a;
Query Plan
==============================================================================
|ID|OPERATOR                                  |NAME    |EST.ROWS|EST.TIME(us)|
------------------------------------------------------------------------------
|0 |PX COORDINATOR                            |        |1       |27          |
|1 |└─EXCHANGE OUT DISTR                      |:EX10002|1       |27          |
|2 |  └─HASH DISTINCT                         |        |1       |26          |
|3 |    └─EXCHANGE IN DISTR                   |        |1       |26          |
|4 |      └─EXCHANGE OUT DISTR (HASH)         |:EX10001|1       |26          |
|5 |        └─HASH DISTINCT                   |        |1       |25          |
|6 |          └─MERGE GROUP BY                |        |1       |25          |
|7 |            └─EXCHANGE IN MERGE SORT DISTR|        |1       |25          |
|8 |              └─EXCHANGE OUT DISTR (HASH) |:EX10000|1       |25          |
|9 |                └─PX PARTITION ITERATOR   |        |1       |24          |
|10|                  └─MERGE GROUP BY        |        |1       |24          |
|11|                    └─TABLE FULL SCAN     |t1(i1)  |1       |24          |
==============================================================================
Outputs & filters:
-------------------------------------
  0 - output([INTERNAL_FUNCTION(T_FUN_SUM(T_FUN_SUM(t1.b)))]), filter(nil), rowset=16
  1 - output([INTERNAL_FUNCTION(T_FUN_SUM(T_FUN_SUM(t1.b)))]), filter(nil), rowset=16
      dop=1
  2 - output([T_FUN_SUM(T_FUN_SUM(t1.b))]), filter(nil), rowset=16
      distinct([T_FUN_SUM(T_FUN_SUM(t1.b))])
  3 - output([T_FUN_SUM(T_FUN_SUM(t1.b))]), filter(nil), rowset=16
  4 - output([T_FUN_SUM(T_FUN_SUM(t1.b))]), filter(nil), rowset=16
      (#keys=1, [T_FUN_SUM(T_FUN_SUM(t1.b))]), dop=1
  5 - output([T_FUN_SUM(T_FUN_SUM(t1.b))]), filter(nil), rowset=16
      distinct([T_FUN_SUM(T_FUN_SUM(t1.b))])
  6 - output([T_FUN_SUM(T_FUN_SUM(t1.b))]), filter(nil), rowset=16
      group([t1.a]), agg_func([T_FUN_SUM(T_FUN_SUM(t1.b))])
  7 - output([t1.a], [T_FUN_SUM(t1.b)]), filter(nil), rowset=16
      sort_keys([t1.a, ASC]), Local Order
  8 - output([t1.a], [T_FUN_SUM(t1.b)]), filter(nil), rowset=16
      (#keys=1, [t1.a]), dop=1
  9 - output([t1.a], [T_FUN_SUM(t1.b)]), filter(nil), rowset=16
      force partition granule
 10 - output([t1.a], [T_FUN_SUM(t1.b)]), filter(nil), rowset=16
      group([t1.a]), agg_func([T_FUN_SUM(t1.b)])
 11 - output([t1.b], [t1.a]), filter(nil), rowset=16
      access([t1.__pk_increment], [t1.b], [t1.a]), partitions(p[0-4])
      is_index_back=true, is_global_index=false,
      range_key([t1.a], [t1.__pk_increment]), range(MIN,MIN ; MAX,MAX)always true
select /*+ index(t1 I1) */ distinct sum(b) a from t1 group by a;
+------+
| a    |
+------+
|    2 |
+------+

drop table t1;
