# owner: yibo.tyf
# owner group: SQL1
# tags: optimizer

--disable_warnings
drop table if exists t1;
--enable_warnings

create table t1 (c1 int, c2 int, c3 int);
create unique index u123 on t1(c1, c2, c3);
create unique index u12 on t1(c1, c2);
create unique index u2 on t1(c2);
insert into t1 (select row_number() over(), row_number() over (), row_number() over() from table(generator(10000)));
call dbms_stats.gather_table_stats(null,'t1');

--result_format 4
--explain_protocol 2

## test common compare condition
select /*+full(t1) no_rewrite*/ * from t1 where c1 = 1 and c2 = 1;
select /*+index(t1 u12) no_rewrite*/ * from t1 where c1 = 1 and c2 = 1;

select /*+full(t1) no_rewrite*/ * from t1 where c1 = 1 and c2 = 1 or c1 = 2 and c2 = 2;
select /*+index(t1 u12) no_rewrite*/ * from t1 where c1 = 1 and c2 = 1 or c1 = 2 and c2 = 2;

select /*+full(t1) no_rewrite*/ * from t1 where c2 = 1;
select /*+index(t1 u2) no_rewrite*/ * from t1 where c2 = 1;

select /*+full(t1) no_rewrite*/ * from t1 where c2 = 1 and c2 <= 1;
select /*+index(t1 u2) no_rewrite*/ * from t1 where c2 = 1 and c2 <= 1;

select /*+full(t1) no_rewrite*/ * from t1 where c2 = 1 and c2 < 1;
select /*+index(t1 u2) no_rewrite*/ * from t1 where c2 = 1 and c2 < 1;

select /*+full(t1) no_rewrite*/ * from t1 where c2 = 1 or c2 > 9999;
select /*+index(t1 u2) no_rewrite*/ * from t1 where c2 = 1 or c2 > 9999;

select /*+full(t1) no_rewrite*/ * from t1 where ((c1 = 1 and c3 = 1) or (c1 = 2 and c3 = 2)) and c2 = 1;
select /*+index(t1 u12) no_rewrite*/ * from t1 where ((c1 = 1 and c3 = 1) or (c1 = 2 and c3 = 2)) and c2 = 1;
select /*+index(t1 u123) no_rewrite*/ * from t1 where ((c1 = 1 and c3 = 1) or (c1 = 2 and c3 = 2)) and c2 = 1;

## test in condition
select /*+full(t1) no_rewrite*/ * from t1 where c2 in (1,2,3);
select /*+index(t1 u2) no_rewrite*/ * from t1 where c2 in (1,2,3);

select /*+full(t1) no_rewrite*/ * from t1 where (c1, c2) in ((1,1),(2,2),(3,3));
select /*+index(t1 u12) no_rewrite*/ * from t1 where (c1, c2) in ((1,1),(2,2),(3,3));

drop table t1;