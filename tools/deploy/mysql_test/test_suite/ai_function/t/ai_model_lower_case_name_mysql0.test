#owner: shenyunlong.syl
#owner group: shenzhen

### Test when lower_case_table_names = 0, cafe, CAFE, café is different

connect (sys,$OBMYSQL_MS0,root,,oceanbase,$OBMYSQL_PORT);
connection sys;

let $zone = query_get_value(select zone from oceanbase.DBA_OB_ZONES, zone, 1);
#let $unit_num = query_get_value(select count(*) as c from oceanbase.DBA_OB_SERVERS group by zone, c, 1);

--disable_query_log
--disable_warnings
#drop tenant if exists tenant_lower_case FORCE;
#drop resource pool if exists pool_lower_case;
#drop resource unit if exists uint_lower_case;

#eval CREATE RESOURCE UNIT uint_lower_case MAX_CPU=1, MEMORY_SIZE='2G';
#eval CREATE RESOURCE POOL pool_lower_case UNIT='uint_lower_case', UNIT_NUM=$unit_num;
#eval CREATE TENANT tenant_lower_case PRIMARY_ZONE = $zone, REPLICA_NUM = 1, RESOURCE_POOL_LIST = ('pool_lower_case') set ob_tcp_invited_nodes='%', ob_compatibility_mode='mysql', lower_case_table_names=0;

let $__tenant_name__ = 'sys';
--source mysql_test/include/get_tenant_server.inc
connect (conn_lower_case_root, $TE_SERVER_IP, root,,test, $TE_SERVER_PORT);
connection conn_lower_case_root;
--enable_query_log

--error 0,11118
call DBMS_AI_SERVICE.DROP_AI_MODEL('cafe');
--error 0,11118
call DBMS_AI_SERVICE.DROP_AI_MODEL('CAFE');
--error 0,11118
call DBMS_AI_SERVICE.DROP_AI_MODEL('café');

call DBMS_AI_SERVICE.CREATE_AI_MODEL(
  'cafe', '{
    "type": "dense_embedding",
    "model_name": "text-embedding-v1"
  }');
select NAME, TYPE, MODEL_NAME from oceanbase.DBA_OB_AI_MODELS where NAME in ('cafe', 'CAFE', 'café');

#call DBMS_AI_SERVICE.CREATE_AI_MODEL(
#  'CAFE', '{
#    "type": "sparse_embedding",
#    "model_name": "text-embedding-v1"
#  }');
#select NAME, TYPE, MODEL_NAME from oceanbase.DBA_OB_AI_MODELS where NAME in ('cafe', 'CAFE', 'café');
--error 11119
call DBMS_AI_SERVICE.CREATE_AI_MODEL(
  'café', '{
    "type": "dense_embedding",
    "model_name": "text-embedding-v2"
  }');
select NAME, TYPE, MODEL_NAME from oceanbase.DBA_OB_AI_MODELS where NAME in ('cafe', 'CAFE', 'café');

call DBMS_AI_SERVICE.DROP_AI_MODEL('CAFE');
select NAME, TYPE, MODEL_NAME from oceanbase.DBA_OB_AI_MODELS where NAME in ('cafe', 'CAFE', 'café');
--error 11118
call DBMS_AI_SERVICE.DROP_AI_MODEL('cafe');
select NAME, TYPE, MODEL_NAME from oceanbase.DBA_OB_AI_MODELS where NAME in ('cafe', 'CAFE', 'café');
--error 11118
call DBMS_AI_SERVICE.DROP_AI_MODEL('café');
select NAME, TYPE, MODEL_NAME from oceanbase.DBA_OB_AI_MODELS where NAME in ('cafe', 'CAFE', 'café');

connection sys;
--disable_query_log
#drop tenant tenant_lower_case force;
#drop resource pool pool_lower_case;
#drop resource unit uint_lower_case;
--enable_query_log
