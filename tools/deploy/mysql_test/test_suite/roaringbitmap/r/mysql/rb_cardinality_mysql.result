# ----------------------------------------------------------------------
# Base test of rb_cardinality.
# ----------------------------------------------------------------------
drop table if exists t1,t2;
select rb_cardinality(null);
rb_cardinality(null)
NULL
select rb_cardinality('');
ERROR HY000: invalid type given for an argument
select rb_cardinality(x'');
ERROR HY000: Invalid data
select rb_cardinality('aa');
ERROR HY000: invalid type given for an argument
select rb_cardinality(2);
ERROR HY000: invalid type given for an argument
select rb_cardinality(x'0100');
rb_cardinality(x'0100')
0
select rb_cardinality(x'010101000000');
rb_cardinality(x'010101000000')
1
select rb_cardinality(x'01020100000001000000');
rb_cardinality(x'01020100000001000000')
1
select rb_cardinality(x'01030101000000');
ERROR HY000: Invalid data
select rb_cardinality(x'0103020100000002000000');
rb_cardinality(x'0103020100000002000000')
2
select rb_cardinality(x'0104010100000001000000');
ERROR HY000: Invalid data
select rb_cardinality(x'01040201000000010000000100000002000000');
rb_cardinality(x'01040201000000010000000100000002000000')
2
select rb_cardinality(x'01053A30000000000000');
rb_cardinality(x'01053A30000000000000')
0
select rb_cardinality(x'01053a3000000100000000000000100000000100');
rb_cardinality(x'01053a3000000100000000000000100000000100')
1
select rb_cardinality(x'01053a30000001000000000001001000000001000200');
rb_cardinality(x'01053a30000001000000000001001000000001000200')
2
select rb_cardinality(x'01053a3000000100000000001f001000000000000100020003000400050006000700080009000a000b000c000d000e000f0010001100120013001400150016001700180019001a001b001c001d001e001f00');
rb_cardinality(x'01053a3000000100000000001f001000000000000100020003000400050006000700080009000a000b000c000d000e000f0010001100120013001400150016001700180019001a001b001c001d001e001f00')
32
select rb_cardinality(x'01060000000000000000');
rb_cardinality(x'01060000000000000000')
0
select rb_cardinality(x'01060100000000000000000000003a3000000100000000000000100000000100');
rb_cardinality(x'01060100000000000000000000003a3000000100000000000000100000000100')
1
select rb_cardinality(x'01060100000000000000010000003a3000000100000000000000100000000000');
rb_cardinality(x'01060100000000000000010000003a3000000100000000000000100000000000')
1
select rb_cardinality(x'01060100000000000000000000003a30000001000000000001001000000001000200');
rb_cardinality(x'01060100000000000000000000003a30000001000000000001001000000001000200')
2
select rb_cardinality(x'01060200000000000000000000003a3000000100000000000000100000000100010000003a3000000100000000000000100000000000');
rb_cardinality(x'01060200000000000000000000003a3000000100000000000000100000000100010000003a3000000100000000000000100000000000')
2
select rb_cardinality(x'01060100000000000000000000003a3000000100000000001f001000000000000100020003000400050006000700080009000a000b000c000d000e000f0010001100120013001400150016001700180019001a001b001c001d001e001f00');
rb_cardinality(x'01060100000000000000000000003a3000000100000000001f001000000000000100020003000400050006000700080009000a000b000c000d000e000f0010001100120013001400150016001700180019001a001b001c001d001e001f00')
32
select rb_cardinality(x'01060200000000000000000000003a30000001000000ffff000010000000ffff010000003a3000000100000000001e001000000000000100020003000400050006000700080009000a000b000c000d000e000f0010001100120013001400150016001700180019001a001b001c001d001e00');
rb_cardinality(x'01060200000000000000000000003a30000001000000ffff000010000000ffff010000003a3000000100000000001e001000000000000100020003000400050006000700080009000a000b000c000d000e000f0010001100120013001400150016001700180019001a001b001c001d001e00')
32
select rb_cardinality(x'01062000000000000000000000003a3000000100000000000000100000000000010000003a3000000100000000000000100000000000020000003a3000000100000000000000100000000000030000003a3000000100000000000000100000000000040000003a3000000100000000000000100000000000050000003a3000000100000000000000100000000000060000003a3000000100000000000000100000000000070000003a3000000100000000000000100000000000080000003a3000000100000000000000100000000000090000003a30000001000000000000001000000000000a0000003a30000001000000000000001000000000000b0000003a30000001000000000000001000000000000c0000003a30000001000000000000001000000000000d0000003a30000001000000000000001000000000000e0000003a30000001000000000000001000000000000f0000003a3000000100000000000000100000000000100000003a3000000100000000000000100000000000110000003a3000000100000000000000100000000000120000003a3000000100000000000000100000000000130000003a3000000100000000000000100000000000140000003a3000000100000000000000100000000000150000003a3000000100000000000000100000000000160000003a3000000100000000000000100000000000170000003a3000000100000000000000100000000000180000003a3000000100000000000000100000000000190000003a30000001000000000000001000000000001a0000003a30000001000000000000001000000000001b0000003a30000001000000000000001000000000001c0000003a30000001000000000000001000000000001d0000003a30000001000000000000001000000000001e0000003a30000001000000000000001000000000001f0000003a3000000100000000000000100000000000');
rb_cardinality(x'01062000000000000000000000003a3000000100000000000000100000000000010000003a3000000100000000000000100000000000020000003a3000000100000000000000100000000000030000003a3000000100000000000000100000000000040000003a30000001000000000000001000000000
32
select rb_cardinality(x'01060200000000000000000000003a300000020000000000010001000100180000001c0000000100020001000200010000003a300000020000000000010001000100180000001c0000000000010000000100');
rb_cardinality(x'01060200000000000000000000003a300000020000000000010001000100180000001c0000000100020001000200010000003a300000020000000000010001000100180000001c0000000000010000000100')
8
create table t1(c int);
INSERT INTO t1 values(rb_cardinality(x'0100'));
select * from t1;
c
0
select rb_cardinality(x'01053b300000010000e70301000000e703');
rb_cardinality(x'01053b300000010000e70301000000e703')
1000
select rb_cardinality(x'01053b300000010000e90303000000e703d0070000d2070000');
rb_cardinality(x'01053b300000010000e90303000000e703d0070000d2070000')
1002
select rb_cardinality(x'01053b300100030000e7030100e70301000000e70301000000e703');
rb_cardinality(x'01053b300100030000e7030100e70301000000e70301000000e703')
2000
select rb_cardinality(x'01053b300100010000e7030100010001000000e703d007d207');
rb_cardinality(x'01053b300100010000e7030100010001000000e703d007d207')
1002
select rb_cardinality(x'01053b3004001f0000e7030100e7030200e7030300e7030400e7032d00000033000000390000003f0000004500000001000000e70301000000e70301000000e70301000000e70301000000e703');
rb_cardinality(x'01053b3004001f0000e7030100e7030200e7030300e7030400e7032d00000033000000390000003f0000004500000001000000e70301000000e70301000000e70301000000e70301000000e703')
5000
select rb_cardinality(x'01053b3004001e000000000100e7030200e7030300e7030400e7032d0000002f000000350000003b00000041000000010001000000e70301000000e70301000000e70301000000e703');
rb_cardinality(x'01053b3004001e000000000100e7030200e7030300e7030400e7032d0000002f000000350000003b00000041000000010001000000e70301000000e70301000000e70301000000e703')
4001
select rb_cardinality(x'01060100000000000000000000003b300000010000e70301000000e703');
rb_cardinality(x'01060100000000000000000000003b300000010000e70301000000e703')
1000
select rb_cardinality(x'01060100000000000000000000003b300000010000e90303000000e703d0070000d2070000');
rb_cardinality(x'01060100000000000000000000003b300000010000e90303000000e703d0070000d2070000')
1002
select rb_cardinality(x'01060100000000000000000000003b300100030000e7030100e70301000000e70301000000e703');
rb_cardinality(x'01060100000000000000000000003b300100030000e7030100e70301000000e70301000000e703')
2000
select rb_cardinality(x'01060100000000000000000000003b300100010000e7030100010001000000e703d007d207');
rb_cardinality(x'01060100000000000000000000003b300100010000e7030100010001000000e703d007d207')
1002
select rb_cardinality(x'01060100000000000000000000003b3004001f0000e7030100e7030200e7030300e7030400e7032d00000033000000390000003f0000004500000001000000e70301000000e70301000000e70301000000e70301000000e703');
rb_cardinality(x'01060100000000000000000000003b3004001f0000e7030100e7030200e7030300e7030400e7032d00000033000000390000003f0000004500000001000000e70301000000e70301000000e70301000000e70301000000e703')
5000
select rb_cardinality(x'01060100000000000000000000003b3004001e000000000100e7030200e7030300e7030400e7032d0000002f000000350000003b00000041000000010001000000e70301000000e70301000000e70301000000e703');
rb_cardinality(x'01060100000000000000000000003b3004001e000000000100e7030200e7030300e7030400e7032d0000002f000000350000003b00000041000000010001000000e70301000000e70301000000e70301000000e703')
4001
select rb_cardinality(x'01060200000000000000000000003b300000010000e70301000000e703010000003b300000010000e70301000000e703');
rb_cardinality(x'01060200000000000000000000003b300000010000e70301000000e703010000003b300000010000e70301000000e703')
2000
select rb_cardinality(x'01060200000000000000000000003b300000010000e90303000000e703d0070000d2070000020000003b300000010000e90303000000e703d0070000d2070000');
rb_cardinality(x'01060200000000000000000000003b300000010000e90303000000e703d0070000d2070000020000003b300000010000e90303000000e703d0070000d2070000')
2004
select rb_cardinality(x'01060200000000000000000000003b300100030000e7030100e70301000000e70301000000e703010000003b300100030000e7030100e70301000000e70301000000e703');
rb_cardinality(x'01060200000000000000000000003b300100030000e7030100e70301000000e70301000000e703010000003b300100030000e7030100e70301000000e70301000000e703')
4000
select rb_cardinality(x'01060200000000000000000000003b300100010000e7030100010001000000e703d007d207010000003b300100010000e7030100010001000000e703d007d207');
rb_cardinality(x'01060200000000000000000000003b300100010000e7030100010001000000e703d007d207010000003b300100010000e7030100010001000000e703d007d207')
2004
select rb_cardinality(x'01060200000000000000000000003b3004001f0000e7030100e7030200e7030300e7030400e7032d00000033000000390000003f0000004500000001000000e70301000000e70301000000e70301000000e70301000000e703010000003b3004001f0000e7030100e7030200e7030300e7030400e7032d00000033000000390000003f0000004500000001000000e70301000000e70301000000e70301000000e70301000000e703');
rb_cardinality(x'01060200000000000000000000003b3004001f0000e7030100e7030200e7030300e7030400e7032d00000033000000390000003f0000004500000001000000e70301000000e70301000000e70301000000e70301000000e703010000003b3004001f0000e7030100e7030200e7030300e7030400e7032d
10000
select rb_cardinality(x'01060200000000000000000000003b3004001e000000000100e7030200e7030300e7030400e7032d0000002f000000350000003b00000041000000010001000000e70301000000e70301000000e70301000000e703010000003b3004001e000000000100e7030200e7030300e7030400e7032d0000002f000000350000003b00000041000000010001000000e70301000000e70301000000e70301000000e703');
rb_cardinality(x'01060200000000000000000000003b3004001e000000000100e7030200e7030300e7030400e7032d0000002f000000350000003b00000041000000010001000000e70301000000e70301000000e70301000000e703010000003b3004001e000000000100e7030200e7030300e7030400e7032d0000002f
8002
create table t2(rb roaringbitmap, c int generated always as (rb_cardinality(rb)));
INSERT INTO t2(rb) values(x'0100'), (x'010101000000');
select rb_to_string(rb), c from t2;
rb_to_string(rb)	c
	0
1	1
drop table if exists t1,t2;
