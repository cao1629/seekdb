#owner: lana.lgx
#owner group: data

--source mysql_test/include/ignore_drop_mlog_err_mysql.inc
drop materialized view log on t1;
--disable_warnings
DROP TABLE IF EXISTS t1;
--enable_warnings
CREATE TABLE t1 (
  id int primary key,
  name varchar(10),
  age int
);

# create mlog on base table
create materialized view log on t1 with primary key (age) including new values;

# insert data to empty base table
insert into t1 values (1, 'Lucy', 21), (2, 'Tommy', 24), (3, 'Jack', 30), (4, 'May', 22), (5, 'Rose', 23), (6, 'Grace', 34), (7, 'Nancy', 24), (8, 'Jones', 32), (9, 'Jerry', 23), (10, 'Marry', 25);

call dbms_stats.gather_table_stats('TEST', 'MLOG$_T1', method_opt=>'for all columns size 64', estimate_percent=>100);

--replace_regex /version=\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d{6}+/version=stat_version/
explain extended_noaddr select * from mlog$_t1;

drop materialized view log on t1;
drop table t1;