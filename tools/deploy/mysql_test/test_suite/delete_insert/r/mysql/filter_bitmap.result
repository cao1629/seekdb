create table t1(a int primary key, b int, c int) merge_engine = delete_insert;
insert into t1 values(1, 1, 1), (2, 2, 2), (3, 3, 3), (4, 4, 4), (5, 5, 5), (6, 6, 6), (7, 7, 7), (8, 8, 8), (9, 9, 9);
insert into t1 select a + 100, b, c from t1;
insert into t1 select a + 200, b, c from t1;
insert into t1 select a + 400, b, c from t1;
insert into t1 select a + 800, b, c from t1;
insert into t1 select a + 1600, b, c from t1;
insert into t1 select a + 3200, b, c from t1;
insert into t1 select a + 6400, b, c from t1;
insert into t1 select a + 12800, b, c from t1;
insert into t1 select a + 25600, b, c from t1;
alter system major freeze;
update t1 set b = null where a % 100 = 1;
alter system minor freeze;
select * from t1 where a % 100 = 1;
a	b	c
1	NULL	1
101	NULL	1
201	NULL	1
301	NULL	1
401	NULL	1
501	NULL	1
601	NULL	1
701	NULL	1
801	NULL	1
901	NULL	1
1001	NULL	1
1101	NULL	1
1201	NULL	1
1301	NULL	1
1401	NULL	1
1501	NULL	1
1601	NULL	1
1701	NULL	1
1801	NULL	1
1901	NULL	1
2001	NULL	1
2101	NULL	1
2201	NULL	1
2301	NULL	1
2401	NULL	1
2501	NULL	1
2601	NULL	1
2701	NULL	1
2801	NULL	1
2901	NULL	1
3001	NULL	1
3101	NULL	1
3201	NULL	1
3301	NULL	1
3401	NULL	1
3501	NULL	1
3601	NULL	1
3701	NULL	1
3801	NULL	1
3901	NULL	1
4001	NULL	1
4101	NULL	1
4201	NULL	1
4301	NULL	1
4401	NULL	1
4501	NULL	1
4601	NULL	1
4701	NULL	1
4801	NULL	1
4901	NULL	1
5001	NULL	1
5101	NULL	1
5201	NULL	1
5301	NULL	1
5401	NULL	1
5501	NULL	1
5601	NULL	1
5701	NULL	1
5801	NULL	1
5901	NULL	1
6001	NULL	1
6101	NULL	1
6201	NULL	1
6301	NULL	1
6401	NULL	1
6501	NULL	1
6601	NULL	1
6701	NULL	1
6801	NULL	1
6901	NULL	1
7001	NULL	1
7101	NULL	1
7201	NULL	1
7301	NULL	1
7401	NULL	1
7501	NULL	1
7601	NULL	1
7701	NULL	1
7801	NULL	1
7901	NULL	1
8001	NULL	1
8101	NULL	1
8201	NULL	1
8301	NULL	1
8401	NULL	1
8501	NULL	1
8601	NULL	1
8701	NULL	1
8801	NULL	1
8901	NULL	1
9001	NULL	1
9101	NULL	1
9201	NULL	1
9301	NULL	1
9401	NULL	1
9501	NULL	1
9601	NULL	1
9701	NULL	1
9801	NULL	1
9901	NULL	1
10001	NULL	1
10101	NULL	1
10201	NULL	1
10301	NULL	1
10401	NULL	1
10501	NULL	1
10601	NULL	1
10701	NULL	1
10801	NULL	1
10901	NULL	1
11001	NULL	1
11101	NULL	1
11201	NULL	1
11301	NULL	1
11401	NULL	1
11501	NULL	1
11601	NULL	1
11701	NULL	1
11801	NULL	1
11901	NULL	1
12001	NULL	1
12101	NULL	1
12201	NULL	1
12301	NULL	1
12401	NULL	1
12501	NULL	1
12601	NULL	1
12701	NULL	1
12801	NULL	1
12901	NULL	1
13001	NULL	1
13101	NULL	1
13201	NULL	1
13301	NULL	1
13401	NULL	1
13501	NULL	1
13601	NULL	1
13701	NULL	1
13801	NULL	1
13901	NULL	1
14001	NULL	1
14101	NULL	1
14201	NULL	1
14301	NULL	1
14401	NULL	1
14501	NULL	1
14601	NULL	1
14701	NULL	1
14801	NULL	1
14901	NULL	1
15001	NULL	1
15101	NULL	1
15201	NULL	1
15301	NULL	1
15401	NULL	1
15501	NULL	1
15601	NULL	1
15701	NULL	1
15801	NULL	1
15901	NULL	1
16001	NULL	1
16101	NULL	1
16201	NULL	1
16301	NULL	1
16401	NULL	1
16501	NULL	1
16601	NULL	1
16701	NULL	1
16801	NULL	1
16901	NULL	1
17001	NULL	1
17101	NULL	1
17201	NULL	1
17301	NULL	1
17401	NULL	1
17501	NULL	1
17601	NULL	1
17701	NULL	1
17801	NULL	1
17901	NULL	1
18001	NULL	1
18101	NULL	1
18201	NULL	1
18301	NULL	1
18401	NULL	1
18501	NULL	1
18601	NULL	1
18701	NULL	1
18801	NULL	1
18901	NULL	1
19001	NULL	1
19101	NULL	1
19201	NULL	1
19301	NULL	1
19401	NULL	1
19501	NULL	1
19601	NULL	1
19701	NULL	1
19801	NULL	1
19901	NULL	1
20001	NULL	1
20101	NULL	1
20201	NULL	1
20301	NULL	1
20401	NULL	1
20501	NULL	1
20601	NULL	1
20701	NULL	1
20801	NULL	1
20901	NULL	1
21001	NULL	1
21101	NULL	1
21201	NULL	1
21301	NULL	1
21401	NULL	1
21501	NULL	1
21601	NULL	1
21701	NULL	1
21801	NULL	1
21901	NULL	1
22001	NULL	1
22101	NULL	1
22201	NULL	1
22301	NULL	1
22401	NULL	1
22501	NULL	1
22601	NULL	1
22701	NULL	1
22801	NULL	1
22901	NULL	1
23001	NULL	1
23101	NULL	1
23201	NULL	1
23301	NULL	1
23401	NULL	1
23501	NULL	1
23601	NULL	1
23701	NULL	1
23801	NULL	1
23901	NULL	1
24001	NULL	1
24101	NULL	1
24201	NULL	1
24301	NULL	1
24401	NULL	1
24501	NULL	1
24601	NULL	1
24701	NULL	1
24801	NULL	1
24901	NULL	1
25001	NULL	1
25101	NULL	1
25201	NULL	1
25301	NULL	1
25401	NULL	1
25501	NULL	1
25601	NULL	1
25701	NULL	1
25801	NULL	1
25901	NULL	1
26001	NULL	1
26101	NULL	1
26201	NULL	1
26301	NULL	1
26401	NULL	1
26501	NULL	1
26601	NULL	1
26701	NULL	1
26801	NULL	1
26901	NULL	1
27001	NULL	1
27101	NULL	1
27201	NULL	1
27301	NULL	1
27401	NULL	1
27501	NULL	1
27601	NULL	1
27701	NULL	1
27801	NULL	1
27901	NULL	1
28001	NULL	1
28101	NULL	1
28201	NULL	1
28301	NULL	1
28401	NULL	1
28501	NULL	1
28601	NULL	1
28701	NULL	1
28801	NULL	1
28901	NULL	1
29001	NULL	1
29101	NULL	1
29201	NULL	1
29301	NULL	1
29401	NULL	1
29501	NULL	1
29601	NULL	1
29701	NULL	1
29801	NULL	1
29901	NULL	1
30001	NULL	1
30101	NULL	1
30201	NULL	1
30301	NULL	1
30401	NULL	1
30501	NULL	1
30601	NULL	1
30701	NULL	1
30801	NULL	1
30901	NULL	1
31001	NULL	1
31101	NULL	1
31201	NULL	1
31301	NULL	1
31401	NULL	1
31501	NULL	1
31601	NULL	1
31701	NULL	1
31801	NULL	1
31901	NULL	1
32001	NULL	1
32101	NULL	1
32201	NULL	1
32301	NULL	1
32401	NULL	1
32501	NULL	1
32601	NULL	1
32701	NULL	1
32801	NULL	1
32901	NULL	1
33001	NULL	1
33101	NULL	1
33201	NULL	1
33301	NULL	1
33401	NULL	1
33501	NULL	1
33601	NULL	1
33701	NULL	1
33801	NULL	1
33901	NULL	1
34001	NULL	1
34101	NULL	1
34201	NULL	1
34301	NULL	1
34401	NULL	1
34501	NULL	1
34601	NULL	1
34701	NULL	1
34801	NULL	1
34901	NULL	1
35001	NULL	1
35101	NULL	1
35201	NULL	1
35301	NULL	1
35401	NULL	1
35501	NULL	1
35601	NULL	1
35701	NULL	1
35801	NULL	1
35901	NULL	1
36001	NULL	1
36101	NULL	1
36201	NULL	1
36301	NULL	1
36401	NULL	1
36501	NULL	1
36601	NULL	1
36701	NULL	1
36801	NULL	1
36901	NULL	1
37001	NULL	1
37101	NULL	1
37201	NULL	1
37301	NULL	1
37401	NULL	1
37501	NULL	1
37601	NULL	1
37701	NULL	1
37801	NULL	1
37901	NULL	1
38001	NULL	1
38101	NULL	1
38201	NULL	1
38301	NULL	1
38401	NULL	1
38501	NULL	1
38601	NULL	1
38701	NULL	1
38801	NULL	1
38901	NULL	1
39001	NULL	1
39101	NULL	1
39201	NULL	1
39301	NULL	1
39401	NULL	1
39501	NULL	1
39601	NULL	1
39701	NULL	1
39801	NULL	1
39901	NULL	1
40001	NULL	1
40101	NULL	1
40201	NULL	1
40301	NULL	1
40401	NULL	1
40501	NULL	1
40601	NULL	1
40701	NULL	1
40801	NULL	1
40901	NULL	1
41001	NULL	1
41101	NULL	1
41201	NULL	1
41301	NULL	1
41401	NULL	1
41501	NULL	1
41601	NULL	1
41701	NULL	1
41801	NULL	1
41901	NULL	1
42001	NULL	1
42101	NULL	1
42201	NULL	1
42301	NULL	1
42401	NULL	1
42501	NULL	1
42601	NULL	1
42701	NULL	1
42801	NULL	1
42901	NULL	1
43001	NULL	1
43101	NULL	1
43201	NULL	1
43301	NULL	1
43401	NULL	1
43501	NULL	1
43601	NULL	1
43701	NULL	1
43801	NULL	1
43901	NULL	1
44001	NULL	1
44101	NULL	1
44201	NULL	1
44301	NULL	1
44401	NULL	1
44501	NULL	1
44601	NULL	1
44701	NULL	1
44801	NULL	1
44901	NULL	1
45001	NULL	1
45101	NULL	1
45201	NULL	1
45301	NULL	1
45401	NULL	1
45501	NULL	1
45601	NULL	1
45701	NULL	1
45801	NULL	1
45901	NULL	1
46001	NULL	1
46101	NULL	1
46201	NULL	1
46301	NULL	1
46401	NULL	1
46501	NULL	1
46601	NULL	1
46701	NULL	1
46801	NULL	1
46901	NULL	1
47001	NULL	1
47101	NULL	1
47201	NULL	1
47301	NULL	1
47401	NULL	1
47501	NULL	1
47601	NULL	1
47701	NULL	1
47801	NULL	1
47901	NULL	1
48001	NULL	1
48101	NULL	1
48201	NULL	1
48301	NULL	1
48401	NULL	1
48501	NULL	1
48601	NULL	1
48701	NULL	1
48801	NULL	1
48901	NULL	1
49001	NULL	1
49101	NULL	1
49201	NULL	1
49301	NULL	1
49401	NULL	1
49501	NULL	1
49601	NULL	1
49701	NULL	1
49801	NULL	1
49901	NULL	1
50001	NULL	1
50101	NULL	1
50201	NULL	1
50301	NULL	1
50401	NULL	1
50501	NULL	1
50601	NULL	1
50701	NULL	1
50801	NULL	1
50901	NULL	1
51001	NULL	1
51101	NULL	1
create table t2(a int primary key, b int, c int) merge_engine = delete_insert;
insert into t2 values(1, 1, 1), (2, 2, 2), (3, 3, 3), (4, 4, 4), (5, 5, 5), (6, 6, 6), (7, 7, 7), (8, 8, 8), (9, 9, 9);
insert into t2 select a + 100, b, c from t2;
insert into t2 select a + 200, b, c from t2;
insert into t2 select a + 400, b, c from t2;
insert into t2 select a + 800, b, c from t2;
insert into t2 select a + 1600, b, c from t2;
insert into t2 select a + 3200, b, c from t2;
insert into t2 select a + 6400, b, c from t2;
insert into t2 select a + 12800, b, c from t2;
insert into t2 select a + 25600, b, c from t2;
alter system major freeze;
begin;
update t2 set b = null where a % 100 = 1;
select * from t2 where a % 100 = 1;
a	b	c
1	NULL	1
101	NULL	1
201	NULL	1
301	NULL	1
401	NULL	1
501	NULL	1
601	NULL	1
701	NULL	1
801	NULL	1
901	NULL	1
1001	NULL	1
1101	NULL	1
1201	NULL	1
1301	NULL	1
1401	NULL	1
1501	NULL	1
1601	NULL	1
1701	NULL	1
1801	NULL	1
1901	NULL	1
2001	NULL	1
2101	NULL	1
2201	NULL	1
2301	NULL	1
2401	NULL	1
2501	NULL	1
2601	NULL	1
2701	NULL	1
2801	NULL	1
2901	NULL	1
3001	NULL	1
3101	NULL	1
3201	NULL	1
3301	NULL	1
3401	NULL	1
3501	NULL	1
3601	NULL	1
3701	NULL	1
3801	NULL	1
3901	NULL	1
4001	NULL	1
4101	NULL	1
4201	NULL	1
4301	NULL	1
4401	NULL	1
4501	NULL	1
4601	NULL	1
4701	NULL	1
4801	NULL	1
4901	NULL	1
5001	NULL	1
5101	NULL	1
5201	NULL	1
5301	NULL	1
5401	NULL	1
5501	NULL	1
5601	NULL	1
5701	NULL	1
5801	NULL	1
5901	NULL	1
6001	NULL	1
6101	NULL	1
6201	NULL	1
6301	NULL	1
6401	NULL	1
6501	NULL	1
6601	NULL	1
6701	NULL	1
6801	NULL	1
6901	NULL	1
7001	NULL	1
7101	NULL	1
7201	NULL	1
7301	NULL	1
7401	NULL	1
7501	NULL	1
7601	NULL	1
7701	NULL	1
7801	NULL	1
7901	NULL	1
8001	NULL	1
8101	NULL	1
8201	NULL	1
8301	NULL	1
8401	NULL	1
8501	NULL	1
8601	NULL	1
8701	NULL	1
8801	NULL	1
8901	NULL	1
9001	NULL	1
9101	NULL	1
9201	NULL	1
9301	NULL	1
9401	NULL	1
9501	NULL	1
9601	NULL	1
9701	NULL	1
9801	NULL	1
9901	NULL	1
10001	NULL	1
10101	NULL	1
10201	NULL	1
10301	NULL	1
10401	NULL	1
10501	NULL	1
10601	NULL	1
10701	NULL	1
10801	NULL	1
10901	NULL	1
11001	NULL	1
11101	NULL	1
11201	NULL	1
11301	NULL	1
11401	NULL	1
11501	NULL	1
11601	NULL	1
11701	NULL	1
11801	NULL	1
11901	NULL	1
12001	NULL	1
12101	NULL	1
12201	NULL	1
12301	NULL	1
12401	NULL	1
12501	NULL	1
12601	NULL	1
12701	NULL	1
12801	NULL	1
12901	NULL	1
13001	NULL	1
13101	NULL	1
13201	NULL	1
13301	NULL	1
13401	NULL	1
13501	NULL	1
13601	NULL	1
13701	NULL	1
13801	NULL	1
13901	NULL	1
14001	NULL	1
14101	NULL	1
14201	NULL	1
14301	NULL	1
14401	NULL	1
14501	NULL	1
14601	NULL	1
14701	NULL	1
14801	NULL	1
14901	NULL	1
15001	NULL	1
15101	NULL	1
15201	NULL	1
15301	NULL	1
15401	NULL	1
15501	NULL	1
15601	NULL	1
15701	NULL	1
15801	NULL	1
15901	NULL	1
16001	NULL	1
16101	NULL	1
16201	NULL	1
16301	NULL	1
16401	NULL	1
16501	NULL	1
16601	NULL	1
16701	NULL	1
16801	NULL	1
16901	NULL	1
17001	NULL	1
17101	NULL	1
17201	NULL	1
17301	NULL	1
17401	NULL	1
17501	NULL	1
17601	NULL	1
17701	NULL	1
17801	NULL	1
17901	NULL	1
18001	NULL	1
18101	NULL	1
18201	NULL	1
18301	NULL	1
18401	NULL	1
18501	NULL	1
18601	NULL	1
18701	NULL	1
18801	NULL	1
18901	NULL	1
19001	NULL	1
19101	NULL	1
19201	NULL	1
19301	NULL	1
19401	NULL	1
19501	NULL	1
19601	NULL	1
19701	NULL	1
19801	NULL	1
19901	NULL	1
20001	NULL	1
20101	NULL	1
20201	NULL	1
20301	NULL	1
20401	NULL	1
20501	NULL	1
20601	NULL	1
20701	NULL	1
20801	NULL	1
20901	NULL	1
21001	NULL	1
21101	NULL	1
21201	NULL	1
21301	NULL	1
21401	NULL	1
21501	NULL	1
21601	NULL	1
21701	NULL	1
21801	NULL	1
21901	NULL	1
22001	NULL	1
22101	NULL	1
22201	NULL	1
22301	NULL	1
22401	NULL	1
22501	NULL	1
22601	NULL	1
22701	NULL	1
22801	NULL	1
22901	NULL	1
23001	NULL	1
23101	NULL	1
23201	NULL	1
23301	NULL	1
23401	NULL	1
23501	NULL	1
23601	NULL	1
23701	NULL	1
23801	NULL	1
23901	NULL	1
24001	NULL	1
24101	NULL	1
24201	NULL	1
24301	NULL	1
24401	NULL	1
24501	NULL	1
24601	NULL	1
24701	NULL	1
24801	NULL	1
24901	NULL	1
25001	NULL	1
25101	NULL	1
25201	NULL	1
25301	NULL	1
25401	NULL	1
25501	NULL	1
25601	NULL	1
25701	NULL	1
25801	NULL	1
25901	NULL	1
26001	NULL	1
26101	NULL	1
26201	NULL	1
26301	NULL	1
26401	NULL	1
26501	NULL	1
26601	NULL	1
26701	NULL	1
26801	NULL	1
26901	NULL	1
27001	NULL	1
27101	NULL	1
27201	NULL	1
27301	NULL	1
27401	NULL	1
27501	NULL	1
27601	NULL	1
27701	NULL	1
27801	NULL	1
27901	NULL	1
28001	NULL	1
28101	NULL	1
28201	NULL	1
28301	NULL	1
28401	NULL	1
28501	NULL	1
28601	NULL	1
28701	NULL	1
28801	NULL	1
28901	NULL	1
29001	NULL	1
29101	NULL	1
29201	NULL	1
29301	NULL	1
29401	NULL	1
29501	NULL	1
29601	NULL	1
29701	NULL	1
29801	NULL	1
29901	NULL	1
30001	NULL	1
30101	NULL	1
30201	NULL	1
30301	NULL	1
30401	NULL	1
30501	NULL	1
30601	NULL	1
30701	NULL	1
30801	NULL	1
30901	NULL	1
31001	NULL	1
31101	NULL	1
31201	NULL	1
31301	NULL	1
31401	NULL	1
31501	NULL	1
31601	NULL	1
31701	NULL	1
31801	NULL	1
31901	NULL	1
32001	NULL	1
32101	NULL	1
32201	NULL	1
32301	NULL	1
32401	NULL	1
32501	NULL	1
32601	NULL	1
32701	NULL	1
32801	NULL	1
32901	NULL	1
33001	NULL	1
33101	NULL	1
33201	NULL	1
33301	NULL	1
33401	NULL	1
33501	NULL	1
33601	NULL	1
33701	NULL	1
33801	NULL	1
33901	NULL	1
34001	NULL	1
34101	NULL	1
34201	NULL	1
34301	NULL	1
34401	NULL	1
34501	NULL	1
34601	NULL	1
34701	NULL	1
34801	NULL	1
34901	NULL	1
35001	NULL	1
35101	NULL	1
35201	NULL	1
35301	NULL	1
35401	NULL	1
35501	NULL	1
35601	NULL	1
35701	NULL	1
35801	NULL	1
35901	NULL	1
36001	NULL	1
36101	NULL	1
36201	NULL	1
36301	NULL	1
36401	NULL	1
36501	NULL	1
36601	NULL	1
36701	NULL	1
36801	NULL	1
36901	NULL	1
37001	NULL	1
37101	NULL	1
37201	NULL	1
37301	NULL	1
37401	NULL	1
37501	NULL	1
37601	NULL	1
37701	NULL	1
37801	NULL	1
37901	NULL	1
38001	NULL	1
38101	NULL	1
38201	NULL	1
38301	NULL	1
38401	NULL	1
38501	NULL	1
38601	NULL	1
38701	NULL	1
38801	NULL	1
38901	NULL	1
39001	NULL	1
39101	NULL	1
39201	NULL	1
39301	NULL	1
39401	NULL	1
39501	NULL	1
39601	NULL	1
39701	NULL	1
39801	NULL	1
39901	NULL	1
40001	NULL	1
40101	NULL	1
40201	NULL	1
40301	NULL	1
40401	NULL	1
40501	NULL	1
40601	NULL	1
40701	NULL	1
40801	NULL	1
40901	NULL	1
41001	NULL	1
41101	NULL	1
41201	NULL	1
41301	NULL	1
41401	NULL	1
41501	NULL	1
41601	NULL	1
41701	NULL	1
41801	NULL	1
41901	NULL	1
42001	NULL	1
42101	NULL	1
42201	NULL	1
42301	NULL	1
42401	NULL	1
42501	NULL	1
42601	NULL	1
42701	NULL	1
42801	NULL	1
42901	NULL	1
43001	NULL	1
43101	NULL	1
43201	NULL	1
43301	NULL	1
43401	NULL	1
43501	NULL	1
43601	NULL	1
43701	NULL	1
43801	NULL	1
43901	NULL	1
44001	NULL	1
44101	NULL	1
44201	NULL	1
44301	NULL	1
44401	NULL	1
44501	NULL	1
44601	NULL	1
44701	NULL	1
44801	NULL	1
44901	NULL	1
45001	NULL	1
45101	NULL	1
45201	NULL	1
45301	NULL	1
45401	NULL	1
45501	NULL	1
45601	NULL	1
45701	NULL	1
45801	NULL	1
45901	NULL	1
46001	NULL	1
46101	NULL	1
46201	NULL	1
46301	NULL	1
46401	NULL	1
46501	NULL	1
46601	NULL	1
46701	NULL	1
46801	NULL	1
46901	NULL	1
47001	NULL	1
47101	NULL	1
47201	NULL	1
47301	NULL	1
47401	NULL	1
47501	NULL	1
47601	NULL	1
47701	NULL	1
47801	NULL	1
47901	NULL	1
48001	NULL	1
48101	NULL	1
48201	NULL	1
48301	NULL	1
48401	NULL	1
48501	NULL	1
48601	NULL	1
48701	NULL	1
48801	NULL	1
48901	NULL	1
49001	NULL	1
49101	NULL	1
49201	NULL	1
49301	NULL	1
49401	NULL	1
49501	NULL	1
49601	NULL	1
49701	NULL	1
49801	NULL	1
49901	NULL	1
50001	NULL	1
50101	NULL	1
50201	NULL	1
50301	NULL	1
50401	NULL	1
50501	NULL	1
50601	NULL	1
50701	NULL	1
50801	NULL	1
50901	NULL	1
51001	NULL	1
51101	NULL	1
commit;
create table t3(a int primary key, b int, c int) merge_engine = delete_insert;
insert into t3 values(1, 1, 1), (2, 2, 2);
alter system major freeze;
delete from t3 where a = 1;
alter system minor freeze;
insert into t3 values(1, 2, 3);
select * from t3;
a	b	c
1	2	3
2	2	2
