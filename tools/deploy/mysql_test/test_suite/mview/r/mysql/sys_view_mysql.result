drop materialized view if exists mv;
drop materialized view log on t1;
drop materialized view log on t2;
drop table if exists t1;
drop table if exists t2;
create table t1(a int primary key, b int) partition by hash(a) partitions 4;
create table t2(c int primary key, d int) partition by hash(c) partitions 4;
create materialized view log on t1 parallel 7 with primary key, rowid, sequence (b) including new values PURGE START WITH sysdate() NEXT sysdate() + INTERVAL 120 second;
create materialized view log on t2 parallel 7 with primary key, rowid, sequence (d) including new values PURGE START WITH sysdate() NEXT sysdate() + INTERVAL 120 second;
CREATE MATERIALIZED VIEW mv(a,b,c,d)  parallel 10 partition by hash(a) partitions 4 subpartition by hash(c) subpartitions 2
REFRESH fast START WITH sysdate() NEXT sysdate() + INTERVAL 60 second
as  select t1.a, t1.b, t2.c, t2.d from t1 join t2 on t1.a = t2.c;
create index idx on mv(b) local;
select * from information_schema.partitions where table_name='mv' order by 1,2,3,4,5,6,7;
TABLE_CATALOG	TABLE_SCHEMA	TABLE_NAME	PARTITION_NAME	SUBPARTITION_NAME	PARTITION_ORDINAL_POSITION	SUBPARTITION_ORDINAL_POSITION	PARTITION_METHOD	SUBPARTITION_METHOD	PARTITION_EXPRESSION	SUBPARTITION_EXPRESSION	PARTITION_DESCRIPTION	SUBPARTITION_DESCRIPTION	TABLE_ROWS	AVG_ROW_LENGTH	DATA_LENGTH	MAX_DATA_LENGTH	INDEX_LENGTH	DATA_FREE	CREATE_TIME	UPDATE_TIME	CHECK_TIME	CHECKSUM	PARTITION_COMMENT	NODEGROUP	TABLESPACE_NAME
select * from oceanbase.DBA_TAB_SUBPARTITIONS where table_name='mv' order by 1,2,3,4,5,6,7;
TABLE_OWNER	TABLE_NAME	PARTITION_NAME	SUBPARTITION_NAME	HIGH_VALUE	HIGH_VALUE_LENGTH	PARTITION_POSITION	SUBPARTITION_POSITION	TABLESPACE_NAME	PCT_FREE	PCT_USED	INI_TRANS	MAX_TRANS	INITIAL_EXTENT	NEXT_EXTENT	MIN_EXTENT	MAX_EXTENT	MAX_SIZE	PCT_INCREASE	FREELISTS	FREELIST_GROUPS	LOGGING	COMPRESSION	COMPRESS_FOR	NUM_ROWS	BLOCKS	EMPTY_BLOCKS	AVG_SPACE	CHAIN_CNT	AVG_ROW_LEN	SAMPLE_SIZE	LAST_ANALYZED	BUFFER_POOL	FLASH_CACHE	CELL_FLASH_CACHE	GLOBAL_STATS	USER_STATS	INTERVAL	SEGMENT_CREATED	INDEXING	READ_ONLY	INMEMORY	INMEMORY_PRIORITY	INMEMORY_DISTRIBUTE	INMEMORY_COMPRESSION	INMEMORY_DUPLICATE	INMEMORY_SERVICE	INMEMORY_SERVICE_NAME	CELLMEMORY	MEMOPTIMIZE_READ	MEMOPTIMIZE_WRITE
test	mv	p0	p0sp0	NULL	NULL	1	1	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
test	mv	p0	p0sp1	NULL	NULL	1	2	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
test	mv	p1	p1sp0	NULL	NULL	2	1	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
test	mv	p1	p1sp1	NULL	NULL	2	2	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
test	mv	p2	p2sp0	NULL	NULL	3	1	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
test	mv	p2	p2sp1	NULL	NULL	3	2	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
test	mv	p3	p3sp0	NULL	NULL	4	1	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
test	mv	p3	p3sp1	NULL	NULL	4	2	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
select * from oceanbase.DBA_TAB_PARTITIONS where table_name='mv' order by 1,2,3,4,5,6,7;
TABLE_OWNER	TABLE_NAME	COMPOSITE	PARTITION_NAME	SUBPARTITION_COUNT	HIGH_VALUE	HIGH_VALUE_LENGTH	PARTITION_POSITION	TABLESPACE_NAME	PCT_FREE	PCT_USED	INI_TRANS	MAX_TRANS	INITIAL_EXTENT	NEXT_EXTENT	MIN_EXTENT	MAX_EXTENT	MAX_SIZE	PCT_INCREASE	FREELISTS	FREELIST_GROUPS	LOGGING	COMPRESSION	COMPRESS_FOR	NUM_ROWS	BLOCKS	EMPTY_BLOCKS	AVG_SPACE	CHAIN_CNT	AVG_ROW_LEN	SAMPLE_SIZE	LAST_ANALYZED	BUFFER_POOL	FLASH_CACHE	CELL_FLASH_CACHE	GLOBAL_STATS	USER_STATS	IS_NESTED	PARENT_TABLE_PARTITION	INTERVAL	SEGMENT_CREATED	INDEXING	READ_ONLY	INMEMORY	INMEMORY_PRIORITY	INMEMORY_DISTRIBUTE	INMEMORY_COMPRESSION	INMEMORY_DUPLICATE	CELLMEMORY	INMEMORY_SERVICE	INMEMORY_SERVICE_NAME	MEMOPTIMIZE_READ	MEMOPTIMIZE_WRITE
test	mv	YES	p0	2	NULL	NULL	1	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
test	mv	YES	p1	2	NULL	NULL	2	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
test	mv	YES	p2	2	NULL	NULL	3	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
test	mv	YES	p3	2	NULL	NULL	4	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
select * from oceanbase.DBA_OB_TABLE_LOCATIONS where table_name='mv' and role='LEADER' order by 1,2,3,4,5,6,7;
DATABASE_NAME	TABLE_NAME	TABLE_ID	TABLE_TYPE	PARTITION_NAME	SUBPARTITION_NAME	INDEX_NAME	DATA_TABLE_ID	TABLET_ID	LS_ID	ZONE	SVR_IP	SVR_PORT	ROLE	REPLICA_TYPE	DUPLICATE_SCOPE	DUPLICATE_READ_CONSISTENCY	OBJECT_ID	TABLEGROUP_NAME	TABLEGROUP_ID	SHARDING
test	mv	table_id	USER TABLE	p0	p0sp0	NULL	NULL	tablet_id	ls_id	z1	ip	port	LEADER	FULL	NONE	NONE	object_id	NULL	NULL	NULL
test	mv	table_id	USER TABLE	p0	p0sp1	NULL	NULL	tablet_id	ls_id	z1	ip	port	LEADER	FULL	NONE	NONE	object_id	NULL	NULL	NULL
test	mv	table_id	USER TABLE	p1	p1sp0	NULL	NULL	tablet_id	ls_id	z1	ip	port	LEADER	FULL	NONE	NONE	object_id	NULL	NULL	NULL
test	mv	table_id	USER TABLE	p1	p1sp1	NULL	NULL	tablet_id	ls_id	z1	ip	port	LEADER	FULL	NONE	NONE	object_id	NULL	NULL	NULL
test	mv	table_id	USER TABLE	p2	p2sp0	NULL	NULL	tablet_id	ls_id	z1	ip	port	LEADER	FULL	NONE	NONE	object_id	NULL	NULL	NULL
test	mv	table_id	USER TABLE	p2	p2sp1	NULL	NULL	tablet_id	ls_id	z1	ip	port	LEADER	FULL	NONE	NONE	object_id	NULL	NULL	NULL
test	mv	table_id	USER TABLE	p3	p3sp0	NULL	NULL	tablet_id	ls_id	z1	ip	port	LEADER	FULL	NONE	NONE	object_id	NULL	NULL	NULL
test	mv	table_id	USER TABLE	p3	p3sp1	NULL	NULL	tablet_id	ls_id	z1	ip	port	LEADER	FULL	NONE	NONE	object_id	NULL	NULL	NULL
select * from oceanbase.DBA_PART_INDEXES where table_name='mv' order by 1,2,3,4,5,6,7;
OWNER	INDEX_NAME	TABLE_NAME	PARTITIONING_TYPE	SUBPARTITIONING_TYPE	PARTITION_COUNT	DEF_SUBPARTITION_COUNT	PARTITIONING_KEY_COUNT	SUBPARTITIONING_KEY_COUNT	LOCALITY	ALIGNMENT	DEF_TABLESPACE_NAME	DEF_PCT_FREE	DEF_INI_TRANS	DEF_MAX_TRANS	DEF_INITIAL_EXTENT	DEF_NEXT_EXTENT	DEF_MIN_EXTENTS	DEF_MAX_EXTENTS	DEF_MAX_SIZE	DEF_PCT_INCREASE	DEF_FREELISTS	DEF_FREELIST_GROUPS	DEF_LOGGING	DEF_BUFFER_POOL	DEF_FLASH_CACHE	DEF_CELL_FLASH_CACHE	DEF_PARAMETERS	INTERVAL	AUTOLIST	INTERVAL_SUBPARTITION	AUTOLIST_SUBPARTITION
test	idx	mv	HASH	HASH	4	2	1	1	LOCAL	NON_PREFIXED	NULL	0	0	0	NULL	NULL	NULL	NULL	NULL	NULL	0	0	NULL	NULL	NULL	NULL	NULL	NO	NO	NULL	NULL
select * from oceanbase.CDB_TAB_SUBPARTITIONS where table_name='mv' order by 1,2,3,4,5,6,7;
CON_ID	TABLE_OWNER	TABLE_NAME	PARTITION_NAME	SUBPARTITION_NAME	HIGH_VALUE	HIGH_VALUE_LENGTH	PARTITION_POSITION	SUBPARTITION_POSITION	TABLESPACE_NAME	PCT_FREE	PCT_USED	INI_TRANS	MAX_TRANS	INITIAL_EXTENT	NEXT_EXTENT	MIN_EXTENT	MAX_EXTENT	MAX_SIZE	PCT_INCREASE	FREELISTS	FREELIST_GROUPS	LOGGING	COMPRESSION	COMPRESS_FOR	NUM_ROWS	BLOCKS	EMPTY_BLOCKS	AVG_SPACE	CHAIN_CNT	AVG_ROW_LEN	SAMPLE_SIZE	LAST_ANALYZED	BUFFER_POOL	FLASH_CACHE	CELL_FLASH_CACHE	GLOBAL_STATS	USER_STATS	INTERVAL	SEGMENT_CREATED	INDEXING	READ_ONLY	INMEMORY	INMEMORY_PRIORITY	INMEMORY_DISTRIBUTE	INMEMORY_COMPRESSION	INMEMORY_DUPLICATE	INMEMORY_SERVICE	INMEMORY_SERVICE_NAME	CELLMEMORY	MEMOPTIMIZE_READ	MEMOPTIMIZE_WRITE
tenant_id	test	mv	p0	p0sp0	NULL	NULL	1	1	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
tenant_id	test	mv	p0	p0sp1	NULL	NULL	1	2	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
tenant_id	test	mv	p1	p1sp0	NULL	NULL	2	1	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
tenant_id	test	mv	p1	p1sp1	NULL	NULL	2	2	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
tenant_id	test	mv	p2	p2sp0	NULL	NULL	3	1	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
tenant_id	test	mv	p2	p2sp1	NULL	NULL	3	2	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
tenant_id	test	mv	p3	p3sp0	NULL	NULL	4	1	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
tenant_id	test	mv	p3	p3sp1	NULL	NULL	4	2	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
select * from oceanbase.CDB_TAB_PARTITIONS where table_name='mv' order by 1,2,3,4,5,6,7;
CON_ID	TABLE_OWNER	TABLE_NAME	COMPOSITE	PARTITION_NAME	SUBPARTITION_COUNT	HIGH_VALUE	HIGH_VALUE_LENGTH	PARTITION_POSITION	TABLESPACE_NAME	PCT_FREE	PCT_USED	INI_TRANS	MAX_TRANS	INITIAL_EXTENT	NEXT_EXTENT	MIN_EXTENT	MAX_EXTENT	MAX_SIZE	PCT_INCREASE	FREELISTS	FREELIST_GROUPS	LOGGING	COMPRESSION	COMPRESS_FOR	NUM_ROWS	BLOCKS	EMPTY_BLOCKS	AVG_SPACE	CHAIN_CNT	AVG_ROW_LEN	SAMPLE_SIZE	LAST_ANALYZED	BUFFER_POOL	FLASH_CACHE	CELL_FLASH_CACHE	GLOBAL_STATS	USER_STATS	IS_NESTED	PARENT_TABLE_PARTITION	INTERVAL	SEGMENT_CREATED	INDEXING	READ_ONLY	INMEMORY	INMEMORY_PRIORITY	INMEMORY_DISTRIBUTE	INMEMORY_COMPRESSION	INMEMORY_DUPLICATE	CELLMEMORY	INMEMORY_SERVICE	INMEMORY_SERVICE_NAME	MEMOPTIMIZE_READ	MEMOPTIMIZE_WRITE
tenant_id	test	mv	YES	p0	2	NULL	NULL	1	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
tenant_id	test	mv	YES	p1	2	NULL	NULL	2	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
tenant_id	test	mv	YES	p2	2	NULL	NULL	3	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
tenant_id	test	mv	YES	p3	2	NULL	NULL	4	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DISABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
select * from oceanbase.CDB_OB_TABLE_LOCATIONS where table_name='mv' and role='LEADER' order by 1,2,3,4,5,6,7;
TENANT_ID	DATABASE_NAME	TABLE_NAME	TABLE_ID	TABLE_TYPE	PARTITION_NAME	SUBPARTITION_NAME	INDEX_NAME	DATA_TABLE_ID	TABLET_ID	LS_ID	ZONE	SVR_IP	SVR_PORT	ROLE	REPLICA_TYPE	DUPLICATE_SCOPE	DUPLICATE_READ_CONSISTENCY	OBJECT_ID	TABLEGROUP_NAME	TABLEGROUP_ID	SHARDING
tenant_id	test	mv	table_id	USER TABLE	p0	p0sp0	NULL	NULL	tablet_id	ls_id	z1	ip	port	LEADER	FULL	NONE	NONE	object_id	NULL	NULL	NULL
tenant_id	test	mv	table_id	USER TABLE	p0	p0sp1	NULL	NULL	tablet_id	ls_id	z1	ip	port	LEADER	FULL	NONE	NONE	object_id	NULL	NULL	NULL
tenant_id	test	mv	table_id	USER TABLE	p1	p1sp0	NULL	NULL	tablet_id	ls_id	z1	ip	port	LEADER	FULL	NONE	NONE	object_id	NULL	NULL	NULL
tenant_id	test	mv	table_id	USER TABLE	p1	p1sp1	NULL	NULL	tablet_id	ls_id	z1	ip	port	LEADER	FULL	NONE	NONE	object_id	NULL	NULL	NULL
tenant_id	test	mv	table_id	USER TABLE	p2	p2sp0	NULL	NULL	tablet_id	ls_id	z1	ip	port	LEADER	FULL	NONE	NONE	object_id	NULL	NULL	NULL
tenant_id	test	mv	table_id	USER TABLE	p2	p2sp1	NULL	NULL	tablet_id	ls_id	z1	ip	port	LEADER	FULL	NONE	NONE	object_id	NULL	NULL	NULL
tenant_id	test	mv	table_id	USER TABLE	p3	p3sp0	NULL	NULL	tablet_id	ls_id	z1	ip	port	LEADER	FULL	NONE	NONE	object_id	NULL	NULL	NULL
tenant_id	test	mv	table_id	USER TABLE	p3	p3sp1	NULL	NULL	tablet_id	ls_id	z1	ip	port	LEADER	FULL	NONE	NONE	object_id	NULL	NULL	NULL
select * from oceanbase.CDB_PART_INDEXES where table_name='mv' order by 1,2,3,4,5,6,7;
CON_ID	OWNER	INDEX_NAME	TABLE_NAME	PARTITIONING_TYPE	SUBPARTITIONING_TYPE	PARTITION_COUNT	DEF_SUBPARTITION_COUNT	PARTITIONING_KEY_COUNT	SUBPARTITIONING_KEY_COUNT	LOCALITY	ALIGNMENT	DEF_TABLESPACE_NAME	DEF_PCT_FREE	DEF_INI_TRANS	DEF_MAX_TRANS	DEF_INITIAL_EXTENT	DEF_NEXT_EXTENT	DEF_MIN_EXTENTS	DEF_MAX_EXTENTS	DEF_MAX_SIZE	DEF_PCT_INCREASE	DEF_FREELISTS	DEF_FREELIST_GROUPS	DEF_LOGGING	DEF_BUFFER_POOL	DEF_FLASH_CACHE	DEF_CELL_FLASH_CACHE	DEF_PARAMETERS	INTERVAL	AUTOLIST	INTERVAL_SUBPARTITION	AUTOLIST_SUBPARTITION
tenant_id	test	idx	mv	HASH	HASH	4	2	1	1	LOCAL	NON_PREFIXED	NULL	0	0	0	NULL	NULL	NULL	NULL	NULL	NULL	0	0	NULL	NULL	NULL	NULL	NULL	NO	NO	NULL	NULL
select * from oceanbase.CDB_INDEXES where table_name='mv' order by 1,2,3,4,5,6,7;
CON_ID	OWNER	INDEX_NAME	INDEX_TYPE	TABLE_OWNER	TABLE_NAME	TABLE_TYPE	UNIQUENESS	COMPRESSION	PREFIX_LENGTH	TABLESPACE_NAME	INI_TRANS	MAX_TRANS	INITIAL_EXTENT	NEXT_EXTENT	MIN_EXTENTS	MAX_EXTENTS	PCT_INCREASE	PCT_THRESHOLD	INCLUDE_COLUMN	FREELISTS	FREELIST_GROUPS	PCT_FREE	LOGGING	BLEVEL	LEAF_BLOCKS	DISTINCT_KEYS	AVG_LEAF_BLOCKS_PER_KEY	AVG_DATA_BLOCKS_PER_KEY	CLUSTERING_FACTOR	STATUS	NUM_ROWS	SAMPLE_SIZE	LAST_ANALYZED	DEGREE	INSTANCES	PARTITIONED	TEMPORARY	GENERATED	SECONDARY	BUFFER_POOL	FLASH_CACHE	CELL_FLASH_CACHE	USER_STATS	DURATION	PCT_DIRECT_ACCESS	ITYP_OWNER	ITYP_NAME	PARAMETERS	GLOBAL_STATS	DOMIDX_STATUS	DOMIDX_OPSTATUS	FUNCIDX_STATUS	JOIN_INDEX	IOT_REDUNDANT_PKEY_ELIM	DROPPED	VISIBILITY	DOMIDX_MANAGEMENT	SEGMENT_CREATED	ORPHANED_ENTRIES	INDEXING	AUTO
tenant_id	test	idx	NORMAL	test	mv	TABLE	NONUNIQUE	ENABLED	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	VALID	NULL	NULL	NULL	1	NULL	YES	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NO	NULL	NO	VISIBLE	NULL	NULL	NULL	NULL	NULL
drop materialized view log on t1;
drop materialized view log on t2;
drop materialized view if exists mv;
drop table if exists t1;
drop table if exists t2;
